<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: TestCentricity::ExcelData
  
    &mdash; Documentation by YARD 0.9.28
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "TestCentricity::ExcelData";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../TestCentricity.html" title="TestCentricity (module)">TestCentricity</a></span></span>
     &raquo; 
    <span class="title">ExcelData</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: TestCentricity::ExcelData
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">TestCentricity::ExcelData</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/testcentricity_web/data_objects/excel_helper.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_range_data-class_method" title="read_range_data (class method)">.<strong>read_range_data</strong>(file, sheet, range_spec)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_row_data-class_method" title="read_row_data (class method)">.<strong>read_row_data</strong>(file, sheet, row_spec, columns = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_row_from_pool-class_method" title="read_row_from_pool (class method)">.<strong>read_row_from_pool</strong>(file, sheet, row_spec, columns = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>:nocov:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#row_spec_exists%3F-class_method" title="row_spec_exists? (class method)">.<strong>row_spec_exists?</strong>(file, sheet, row_spec)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#worksheet_exists%3F-class_method" title="worksheet_exists? (class method)">.<strong>worksheet_exists?</strong>(file, sheet)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_row_data-class_method" title="write_row_data (class method)">.<strong>write_row_data</strong>(file, sheet, row_spec, row_data)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="read_range_data-class_method">
  
    .<strong>read_range_data</strong>(file, sheet, range_spec)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/testcentricity_web/data_objects/excel_helper.rb', line 180</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_read_range_data'>read_range_data</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_range_spec'>range_spec</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not exists</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_book'>work_book</span>  <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_sheet'>work_sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='lparen'>(</span><span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>
  <span class='comment'># get column headings from row 0 of worksheet
</span>  <span class='id identifier rubyid_headings'>headings</span> <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_heading'>heading</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ROW_NAME</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named ROW_NAME in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
  <span class='comment'># find cell(s) in ROW_NAME column containing a string that matches the range_spec parameter
</span>  <span class='id identifier rubyid_found'>found</span>      <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_range_spec'>range_spec</span>
      <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_row_number'>row_number</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a row named &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_range_spec'>range_spec</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_read_row_data'>read_row_data</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_row_data-class_method">
  
    .<strong>read_row_data</strong>(file, sheet, row_spec, columns = nil)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/testcentricity_web/data_objects/excel_helper.rb', line 55</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_read_row_data'>read_row_data</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='comma'>,</span> <span class='id identifier rubyid_columns'>columns</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not exists</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_book'>work_book</span>  <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_sheet'>work_sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='lparen'>(</span><span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>
  <span class='comment'># get column headings from row 0 of worksheet
</span>  <span class='id identifier rubyid_headings'>headings</span> <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='comment'># if row_spec is a string then we have to find a matching row name
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></span>
    <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_heading'>heading</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ROW_NAME</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named ROW_NAME in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
    <span class='comment'># find first cell in ROW_NAME column containing a string that matches the row_spec parameter
</span>    <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_row_spec'>row_spec</span>
        <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a row named &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row_spec'>row_spec</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='id identifier rubyid_row_number'>row_number</span><span class='rparen'>)</span>
    <span class='comment'># if row_spec is a number then ensure that it doesn&#39;t exceed the number of available rows
</span>  <span class='kw'>elsif</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Numeric</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Row # </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row_spec'>row_spec</span><span class='embexpr_end'>}</span><span class='tstring_content'> is greater than number of rows in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_row_spec'>row_spec</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_last_row_index'>last_row_index</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='id identifier rubyid_row_spec'>row_spec</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># if no columns have been specified, return all columns
</span>  <span class='id identifier rubyid_columns'>columns</span> <span class='op'>=</span> <span class='id identifier rubyid_headings'>headings</span> <span class='kw'>if</span> <span class='id identifier rubyid_columns'>columns</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='comment'># create results hash table
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_columns'>columns</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column'>column</span><span class='op'>|</span>
    <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_column'>column</span> <span class='op'>==</span> <span class='id identifier rubyid_heading'>heading</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_calculate_dynamic_value'>calculate_dynamic_value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eval!</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_column'>column</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
        <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_column'>column</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_row_from_pool-class_method">
  
    .<strong>read_row_from_pool</strong>(file, sheet, row_spec, columns = nil)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>:nocov:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/testcentricity_web/data_objects/excel_helper.rb', line 114</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_read_row_from_pool'>read_row_from_pool</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='comma'>,</span> <span class='id identifier rubyid_columns'>columns</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not exists</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_book'>work_book</span>  <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_sheet'>work_sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='lparen'>(</span><span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_pool_spec_key'>pool_spec_key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row_spec'>row_spec</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='ivar'>@mru</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='id identifier rubyid_pool_spec_key'>pool_spec_key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_pool_spec'>pool_spec</span> <span class='op'>=</span> <span class='ivar'>@mru</span><span class='lbracket'>[</span><span class='id identifier rubyid_pool_spec_key'>pool_spec_key</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_row_start'>row_start</span> <span class='op'>=</span> <span class='id identifier rubyid_pool_spec'>pool_spec</span><span class='lbracket'>[</span><span class='symbol'>:start_row</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_row_end'>row_end</span>   <span class='op'>=</span> <span class='id identifier rubyid_pool_spec'>pool_spec</span><span class='lbracket'>[</span><span class='symbol'>:num_rows</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_pool_rows'>pool_rows</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_row_start'>row_start</span><span class='op'>..</span><span class='id identifier rubyid_row_start'>row_start</span> <span class='op'>+</span> <span class='id identifier rubyid_row_end'>row_end</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
    <span class='id identifier rubyid_mru_rows'>mru_rows</span>  <span class='op'>=</span> <span class='id identifier rubyid_pool_spec'>pool_spec</span><span class='lbracket'>[</span><span class='symbol'>:used_rows</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_new_row'>new_row</span>   <span class='op'>=</span> <span class='id identifier rubyid_pool_rows'>pool_rows</span><span class='period'>.</span><span class='id identifier rubyid_sample'>sample</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_mru_rows'>mru_rows</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='id identifier rubyid_pool_spec'>pool_spec</span><span class='lbracket'>[</span><span class='symbol'>:num_rows</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_mru_rows'>mru_rows</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_new_row'>new_row</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='kw'>while</span> <span class='id identifier rubyid_mru_rows'>mru_rows</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_new_row'>new_row</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_new_row'>new_row</span> <span class='op'>=</span> <span class='id identifier rubyid_pool_rows'>pool_rows</span><span class='period'>.</span><span class='id identifier rubyid_sample'>sample</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_mru_rows'>mru_rows</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_new_row'>new_row</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_mru_rows'>mru_rows</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_pool_spec'>pool_spec</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>start_row:</span> <span class='id identifier rubyid_row_start'>row_start</span><span class='comma'>,</span>
      <span class='label'>num_rows:</span>  <span class='id identifier rubyid_row_end'>row_end</span><span class='comma'>,</span>
      <span class='label'>used_rows:</span> <span class='id identifier rubyid_mru_rows'>mru_rows</span>
    <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='comment'># get column headings from row 0 of worksheet
</span>    <span class='id identifier rubyid_headings'>headings</span>      <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_found'>found</span>         <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_heading'>heading</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ROW_NAME</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named ROW_NAME in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
    <span class='comment'># find cell(s) in ROW_NAME column containing a string that matches the row_spec parameter
</span>    <span class='id identifier rubyid_found'>found</span>      <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_row_spec'>row_spec</span>
        <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_row_number'>row_number</span><span class='rparen'>)</span>
      <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a row named &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row_spec'>row_spec</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_new_row'>new_row</span>   <span class='op'>=</span> <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_sample'>sample</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_pool_spec'>pool_spec</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>start_row:</span> <span class='id identifier rubyid_found'>found</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>num_rows:</span>  <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span>
      <span class='label'>used_rows:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_new_row'>new_row</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='ivar'>@mru</span><span class='lbracket'>[</span><span class='id identifier rubyid_pool_spec_key'>pool_spec_key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pool_spec'>pool_spec</span>

  <span class='id identifier rubyid_read_row_data'>read_row_data</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_new_row'>new_row</span><span class='comma'>,</span> <span class='id identifier rubyid_columns'>columns</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="row_spec_exists?-class_method">
  
    .<strong>row_spec_exists?</strong>(file, sheet, row_spec)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/testcentricity_web/data_objects/excel_helper.rb', line 23</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_row_spec_exists?'>row_spec_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_worksheet_exists?'>worksheet_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_work_book'>work_book</span>  <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_work_sheet'>work_sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='lparen'>(</span><span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>
    <span class='comment'># get column headings from row 0 of worksheet
</span>    <span class='id identifier rubyid_headings'>headings</span> <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
    <span class='comment'># if row_spec is a string then we have to find a matching row name
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></span>
      <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_heading'>heading</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ROW_NAME</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='kw'>break</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named ROW_NAME in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_exists'>exists</span>
      <span class='comment'># find first cell in ROW_NAME column containing a string that matches the row_spec parameter
</span>      <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_row_spec'>row_spec</span>
          <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='kw'>break</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_exists'>exists</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="worksheet_exists?-class_method">
  
    .<strong>worksheet_exists?</strong>(file, sheet)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/testcentricity_web/data_objects/excel_helper.rb', line 8</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_worksheet_exists?'>worksheet_exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_work_book'>work_book</span>  <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_worksheets'>worksheets</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheets'>worksheets</span>
    <span class='id identifier rubyid_worksheets'>worksheets</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_worksheet'>worksheet</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_sheet'>sheet</span>
        <span class='id identifier rubyid_exists'>exists</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_exists'>exists</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_row_data-class_method">
  
    .<strong>write_row_data</strong>(file, sheet, row_spec, row_data)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/testcentricity_web/data_objects/excel_helper.rb', line 216</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_write_row_data'>write_row_data</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='comma'>,</span> <span class='id identifier rubyid_row_spec'>row_spec</span><span class='comma'>,</span> <span class='id identifier rubyid_row_data'>row_data</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not exists</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_book'>work_book</span>  <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_sheet'>work_sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='lparen'>(</span><span class='id identifier rubyid_sheet'>sheet</span><span class='rparen'>)</span>
  <span class='comment'># get column headings from row 0 of worksheet
</span>  <span class='id identifier rubyid_headings'>headings</span> <span class='op'>=</span> <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='comment'># find a matching row name
</span>  <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_heading'>heading</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ROW_NAME</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named ROW_NAME in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
  <span class='comment'># find first cell in ROW_NAME column containing a string that matches the row_spec parameter
</span>  <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_row_spec'>row_spec</span>
      <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_row_number'>row_number</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a row named &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row_spec'>row_spec</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
  <span class='comment'># iterate through the row_data Hash
</span>  <span class='id identifier rubyid_row_data'>row_data</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_column'>column</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='comment'># find the column heading that matches the specified column name
</span>    <span class='id identifier rubyid_headings'>headings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_heading'>heading</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_heading'>heading</span> <span class='op'>==</span> <span class='id identifier rubyid_column'>column</span>
        <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_column_number'>column_number</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a column named &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_column'>column</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in worksheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sheet'>sheet</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_found'>found</span>
    <span class='comment'># set the value of the specified row and column
</span>    <span class='id identifier rubyid_work_sheet'>work_sheet</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span><span class='lbracket'>[</span><span class='id identifier rubyid_row_number'>row_number</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_column_number'>column_number</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>
  <span class='comment'># iterate through all worksheets so that all worksheets are saved in new Excel document
</span>  <span class='id identifier rubyid_worksheets'>worksheets</span> <span class='op'>=</span> <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_worksheets'>worksheets</span>
  <span class='id identifier rubyid_worksheets'>worksheets</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_worksheet'>worksheet</span><span class='op'>|</span>
    <span class='id identifier rubyid_headings'>headings</span> <span class='op'>=</span> <span class='id identifier rubyid_worksheet'>worksheet</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_worksheet'>worksheet</span><span class='period'>.</span><span class='id identifier rubyid_rows'>rows</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_headings'>headings</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='comment'># write all changes to new Excel document
</span>  <span class='id identifier rubyid_outfile'>outfile</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>output.xls</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_work_book'>work_book</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_outfile'>outfile</span>
  <span class='comment'># delete original Excel document
</span>  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='comment'># rename new Excel document, replacing the original
</span>  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_rename'>rename</span><span class='lparen'>(</span><span class='id identifier rubyid_outfile'>outfile</span><span class='comma'>,</span> <span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jan 17 15:44:36 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-2.7.5).
</div>

    </div>
  </body>
</html>